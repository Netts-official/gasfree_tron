<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GasFree Developer Documentation</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&display=swap" rel="stylesheet" />

  <!-- Подключаем внешний CSS -->
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>

<body class="light-theme">
  <!-- Шапка -->
  <header>
    <div class="header-inner container">
      <!-- Логотип и название проекта -->
      <div class="header-left">
        <img src="home/to/your/projects/gasfree_tron/assets/images/logos/logo.svg" alt="Logo" class="logo">
        <h1 class="site-title">GasFree non official</h1>
      </div>

      <div class="header-right">
        <!-- Дополнительное меню -->
        <nav class="top-menu">
          <a href="https://netts.io/rent/" target="_blank">Energy rent</a>
          <a href="https://t.me/netts_energy_order_bot" target="_blank">Energy bot</a>
          <a href="https://t.me/nettswallet_bot/app" target="_blank">Wallet</a>
          <a href="https://github.com/Netts-official/gasfree_tron" target="_blank">GitHub</a>
        </nav>

        <!-- Переключатель темы -->
        <button class="theme-toggle-btn" id="themeToggleBtn" aria-label="Toggle theme">
          Dark theme
        </button>

        <!-- Версии -->
        <div class="version-switcher">
          <label for="version-select">Version:</label>
          <select id="version-select" onchange="location = this.value;">
            <option value="index.html" selected>1.0.0</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <!-- Боковое меню -->
  <nav class="sidebar">
    <div class="sidebar-content">
      <h2>Table of Contents</h2>
      <div class="table-of-contents">
        <p>Table of Contents</p>
        <ol>
          <li><a href="#overview"><strong>Overview</strong></a></li>
          <li>
            <a href="#authorization-process"><strong>Authorization Process</strong></a>
          </li>
          <li>
            <a href="#signature-algorithm-and-provider-endpoint">
              <strong>Signature Algorithm and Provider Endpoint</strong>
            </a>
            <ol>
              <li><a href="#31-parameters">3.1 Parameters</a></li>
              <li>
                <a href="#32-authorization-construction-and-signature">3.2 Authorization Construction and Signature</a>
              </li>
              <li>
                <a href="#33-provider-endpoint">3.3 Provider Endpoint</a>
              </li>
            </ol>
          </li>
          <li><a href="#notes"><strong>Notes</strong></a></li>
          <li>
            <a href="#apis"><strong>APIs</strong></a>
            <ol>
              <li><a href="#api-authentication">API Authentication</a></li>
              <li><a href="#api-format-definition">API Format Definition</a></li>
              <li>
                <a href="#get-apiv1configtokenall">GET /api/v1/config/token/all</a>
              </li>
              <li>
                <a href="#get-apiv1configproviderall">GET /api/v1/config/provider/all</a>
              </li>
              <li>
                <a href="#get-apiv1addressaccountaddress">GET /api/v1/address/{accountAddress}</a>
              </li>
              <li>
                <a href="#post-apiv1gasfreesubmit">POST /api/v1/gasfree/submit</a>
              </li>
              <li>
                <a href="#get-apiv1gasfreetraceid">GET /api/v1/gasfree/{traceId}</a>
              </li>
            </ol>
          </li>
        </ol>
      </div>

      <!-- Ссылка на репозиторий в боковом меню -->
      <div class="sidebar-repo-link">
        <p><strong>More with scripts on GitHub:</strong></p>
        <p>
          <a href="https://github.com/Netts-official/gasfree_tron" target="_blank" rel="noopener noreferrer">
            github.com/Netts-official/gasfree_tron
          </a>
        </p>
      </div>

      <!-- Нижняя часть бокового меню -->
      <div class="footer__info">
        <p>© 2025 NETTS</p>
        <p>Follow us:</p>
      </div>
      <div class="footer__icons">
        <a href="https://x.com/nettswallet" target="_blank">
          <img src="assets/images/logos/X.svg" alt="X">
        </a>
        <a href="https://t.me/nettswallet" target="_blank">
          <img src="assets/images/logos/telega.svg" alt="Telegram">
        </a>
        <a href="https://debank.com/official/118059" target="_blank">
          <img src="assets/images/logos/debank.png" alt="DeBank">
        </a>
        <a href="https://github.com/Netts-official/gasfree_tron" target="_blank">
          <img src="assets/images/logos/github.svg" alt="GitHub">
        </a>
      </div>
      <div class="footer__contacts">
        <a href="mailto:wallet@netts.io">wallet@netts.io</a>
      </div>
    </div>
  </nav>

  <!-- Основной контент -->
  <main class="content">
    <div class="container">
      <article id="doc-content">
        <!-- Заголовок страницы -->
        <h1 id="gasfree-developer-documentation" style="text-align: center;">Developer Documentation</h1>
        <!-- ================== 1. Overview ================== -->
        <h2 id="overview">1. Overview</h2>
        <p>
          GasFree aims to provide users with a TRC-20/ERC-20 transfer solution
          that does not require a native token to pay for transaction gas fees.
          It specifically includes four roles: GasFree accounts, Service-Providers,
          wallets, and users.
        </p>
        <!-- Картинка по центру страницы -->
        <div class="scheme-image" style="text-align: center; margin: 20px 0;">
          <img src="home/to/your/projects/gasfree_tron/assets/images/schemes/scheme.jpeg" alt="GasFree Framework Scheme"
            style="max-width: 100%; height: auto;">
        </div>
        <p style="text-align: center;"><em>Figure 1. GasFree Framework</em></p>
        <p>
          <strong>GasFree Account:</strong> Generated according to a specific
          algorithm. Its permissions are controlled by the user's EOA (Externally
          Owned Account) address. The user can sign a signature to authorize
          GasFree transfer of this account.
        </p>
        <p>
          <strong>Service-Provider:</strong> The GasFree service-provider is
          responsible for collecting users' GasFree transfer authorizations,
          submitting them to the blockchain, and paying the gas fees on behalf of
          the users. The Service-Provider may charge a certain handling fee after
          the transaction is completed.
        </p>
        <p>
          <strong>Wallet:</strong> After connecting to the GasFree service, the
          wallet provides end-users with interface functions such as fund inquiry
          for GasFree accounts and signature for transfer authorization.
        </p>

        <!-- ================== 2. Authorization Process ================== -->
        <h2 id="authorization-process">2. Authorization Process</h2>
        <p>
          Integrating GasFree into the wallet involves processes such as
          constructing transfer authorization, signing the transfer authorization,
          and the provider submitting the authorization to the blockchain on
          behalf of the user.
        </p>
        <ol>
          <li>
            <p><strong>Prerequisite:</strong></p>
            <ul>
              <li>
                Call <code>/api/v1/config/token/all</code> to obtain the list of
                supported tokens.
              </li>
              <li>
                If a token not supported by the Provider is transferred into a
                GasFree account, use the withdrawal page at
                <a href="https://gasfree.io/withdraw" target="_blank"
                  rel="noopener noreferrer">https://gasfree.io/withdraw</a>
                to withdraw to the EOA address.
              </li>
              <li>
                Call <code>/api/v1/config/provider/all</code> to obtain the
                Service-Providers list.
              </li>
              <li>
                GasFree account is inactive by default and will be activated
                during the first GasFree transfer. An <code>activation fee</code>
                is charged once; subsequent transfers only incur
                <code>transfer fee</code>.
              </li>
            </ul>
          </li>
          <li>
            <p><strong>Preparation:</strong></p>
            <ul>
              <li>
                Call <code>/api/v1/address/{accountAddress}</code> to query the
                GasFree account info and construct the transfer authorization
                accordingly.
              </li>
            </ul>
          </li>
          <li>
            <p><strong>Sign authorization:</strong></p>
            <ul>
              <li>
                The signature algorithm is based on EIP712 (Section 3.2 for
                details).
              </li>
            </ul>
          </li>
          <li>
            <p><strong>Submit authorization:</strong></p>
            <ul>
              <li>
                Use <code>/api/v1/gasfree/submit</code> to send the signed
                transfer authorization to the Service-Provider.
              </li>
            </ul>
          </li>
          <li>
            <p><strong>Handling of provider response:</strong></p>
            <ul>
              <li>
                If successful, provider returns a unique <code>traceId</code> to
                track on-chain status.
              </li>
              <li>
                If failed, the wallet must notify the user of rejection (no
                on-chain transaction).
              </li>
            </ul>
          </li>
          <li>
            <p><strong>Monitoring:</strong></p>
            <ul>
              <li>
                Call <code>/api/v1/gasfree/{traceId}</code> to query the status of
                the authorization.
              </li>
            </ul>
          </li>
        </ol>

        <!-- ================== 3. Signature Algorithm & Provider Endpoint ================== -->
        <h2 id="signature-algorithm-and-provider-endpoint">
          3. Signature Algorithm and Provider Endpoint
        </h2>

        <h3 id="31-parameters">Parameters</h3>
        <p>
          The GasFree transfer authorization involves the following parameters.
          Their values on TRON mainnet and Nile testnet are shown in Table 1.
        </p>
        <table>
          <thead>
            <tr>
              <th>Parameter</th>
              <th>TRON - mainnet</th>
              <th>TRON - Nile testnet</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>chainId</td>
              <td>728126428</td>
              <td>3448148188</td>
            </tr>
            <tr>
              <td>verifyingContract</td>
              <td>TFFAMQLZybALaLb4uxHA9RBE7pxhUAjF3U</td>
              <td>THQGuFzL87ZqhxkgqYEryRAd7gqFqL5rdc</td>
            </tr>
          </tbody>
        </table>
        <p style="text-align:center;">
          <em>Table 1. GasFree Transfer Authorization Parameters</em>
        </p>

        <h3 id="32-authorization-construction-and-signature">
          Authorization Construction and Signature
        </h3>
        <p><strong>General structure</strong></p>
        <p><em>MessageDomain:</em></p>
        <pre><code>const Permit712MessageDomain = {
  name: 'GasFreeController',
  version: 'V1.0.0',
  chainId: 3448148188,
  verifyingContract: 'THQGuFzL87ZqhxkgqYEryRAd7gqFqL5rdc'
};
</code></pre>
        <ul>
          <li>token: address of the transferring token</li>
          <li>name: fixed - 'GasFreeController'</li>
          <li>version: fixed - 'V1.0.0'</li>
          <li>chainId: see Section 3.1</li>
          <li>verifyingContract: see Section 3.1</li>
        </ul>
        <p><em>MessageTypes: fixed value</em></p>
        <pre><code>const Permit712MessageTypes = {
  PermitTransfer: [
    { name: 'token', type: 'address' },
    { name: 'serviceProvider', type: 'address' },
    { name: 'user', type: 'address' },
    { name: 'receiver', type: 'address' },
    { name: 'value', type: 'uint256' },
    { name: 'maxFee', type: 'uint256' },
    { name: 'deadline', type: 'uint256' },
    { name: 'version', type: 'uint256' },
    { name: 'nonce', type: 'uint256' }
  ]
};
</code></pre>
        <p><em>Message body:</em></p>
        <pre><code>const message = {
  token: 'TXYZopYRdj2D9XRtbG411XZZ3kM5VkAeBf',
  serviceProvider: 'TKtWbdzEq5ss9vTS9kwRhBp5mXmBfBns3E',
  user: 'THvMiWQeVPGEMuBtAnuKn2QpuSjqjrGQGu',
  receiver: 'TMDKznuDWaZwfZHcM61FVFstyYNmK6Njk1',
  value: '90000000',
  maxFee: '20000000',
  deadline: '1728638679',
  version: 1,
  nonce: 0
};
</code></pre>
        <p><strong>Sign with Wallet</strong></p>
        <pre><code>const signature = await window.tron.tronWeb.trx._signTypedData(
  Permit712MessageDomain,
  Permit712MessageTypes,
  message
);
</code></pre>

        <h3 id="33-provider-endpoint">Provider Endpoint</h3>
        <p>
          Wallets/users interact with the Provider's endpoint to submit GasFree
          transfer authorizations and query statuses.
        </p>
        <ul>
          <li>
            TRON mainnet:
            <a href="https://openapi.gasfree.io" target="_blank"
              rel="noopener noreferrer">https://openapi.gasfree.io</a>
          </li>
          <li>
            TRON Nile testnet:
            <a href="https://test-nile.gasfree.io" target="_blank"
              rel="noopener noreferrer">https://test-nile.gasfree.io</a>
          </li>
        </ul>
        <p><em>Note: TRON only for now, possibly EVM expansions later.</em></p>

        <!-- ================== 4. Notes ================== -->
        <h2 id="notes">4. Notes</h2>
        <ol>
          <li style="color:red;">
            <strong>It is not recommended that the testnet environment be provided to
              users.</strong>
          </li>
        </ol>
        <p>
          <strong>The GasFree environment on the TRON testnet is for developer testing
            only.</strong>
        </p>
        <p>
          <strong>Disable testnet for ordinary users after official launch to avoid
            loss.</strong>
        </p>
        <ol start="2">
          <li>
            <strong>Verify balance/status before submitting. See GasFree account
              interface definition.</strong>
          </li>
        </ol>
        <p><strong>All amounts are in smallest unit unless stated.</strong></p>

        <!-- ================== 5. APIs ================== -->
        <h2 id="apis">5. APIs</h2>

        <h3 id="api-authentication">API Authentication</h3>
        <p>
          After applying for access, you receive API Key and Secret. Keep Secret
          safe. The signature is transmitted via HTTP headers.
        </p>
        <p><strong>HTTP header definition:</strong></p>
        <pre><code>{
  "Timestamp": 1731912286,
  "Authorization": "ApiKey {api_key}:{signature}"
}
</code></pre>
        <p><strong>Signature steps:</strong></p>
        <ol>
          <li>String = request method + path + timestamp</li>
          <li>signature = base64( HMAC_SHA256( string, API_SECRET ) )</li>
          <li>Append signature to headers</li>
        </ol>
        <p><strong>Python example:</strong></p>
        <pre><code>import hmac
import hashlib
import base64
import time
import requests

API_KEY = 'YOUR_API_KEY'
API_SECRET = 'YOUR_API_SECRET'

method = 'GET'
path = '/api/v1/config/token/all'
timestamp = int(time.time())
message = f'{method}{path}{timestamp}'
signature = base64.b64encode(
    hmac.new(
        API_SECRET.encode('utf-8'),
        message.encode('utf-8'),
        hashlib.sha256
    ).digest()
).decode('utf-8')

url = 'https://test-nile.gasfree.io' + path
headers = {
  'Timestamp': f'{timestamp}',
  'Authorization': f'ApiKey {API_KEY}:{signature}'
}

response = requests.get(url, headers=headers)
print(response.json())
</code></pre>

        <h3 id="api-format-definition">API Format Definition</h3>
        <p>
          When service runs normally, HTTP code = <code>200</code>. Errors appear
          in HTTP body.
        </p>
        <pre><code>{
  "code": 200,
  "reason": null,
  "message": "",
  "data": ""
}
</code></pre>
        <p><strong>Error example:</strong></p>
        <pre><code>{
  "code": 400,
  "reason": "GasFreeAddressNotFoundException",
  "message": "123",
  "data": null
}
</code></pre>
        <p><strong>Success example:</strong></p>
        <pre><code>{
  "code": 200,
  "data": {
    "tokens": [
      {
        "tokenAddress": "TXYZopYRdj2D9XRtbG411XZZ3kM5VkAeBf",
        "activateFee": 10000000,
        "transferFee": 10000000,
        "symbol": "USDT",
        "decimal": 6
      }
    ]
  }
}
</code></pre>

        <h3 id="get-apiv1configtokenall">GET /api/v1/config/token/all</h3>
        <p>Get all supported tokens.</p>

        <h3 id="get-apiv1configproviderall">GET /api/v1/config/provider/all</h3>
        <p>Get all supported service providers.</p>

        <h3 id="get-apiv1addressaccountaddress">
          GET /api/v1/address/{accountAddress}
        </h3>
        <p>Query GasFree account info.</p>

        <h3 id="post-apiv1gasfreesubmit">POST /api/v1/gasfree/submit</h3>
        <p>Initiate a GasFree transfer authorization.</p>

        <h3 id="get-apiv1gasfreetraceid">GET /api/v1/gasfree/{traceId}</h3>
        <p>Query status of a GasFree transfer authorization.</p>
      </article>
    </div>
  </main>

  <!-- Небольшой скрипт для переключения темы -->
  <script>
    const themeToggleBtn = document.getElementById("themeToggleBtn");
    const body = document.body;

    function toggleTheme() {
      if (body.classList.contains("light-theme")) {
        body.classList.remove("light-theme");
        body.classList.add("dark-theme");
        themeToggleBtn.textContent = "Dark theme";
      } else {
        body.classList.remove("dark-theme");
        body.classList.add("light-theme");
        themeToggleBtn.textContent = "White theme";
      }
    }

    themeToggleBtn.addEventListener("click", toggleTheme);
  </script>
</body>

</html>